{% extends 'base.html' %}
{% include 'headers/adminHeader.html' %}

{% block title %} Home {% endblock %}


{% block body %}
{% if product.music_info[0] %}
<div class="container text-white">
  <h3>Album Name</h3>
  {{product.music_info[0].name}}
  <h3>Release Year</h3>
  {{product.music_info[0].year}}
  <h3>Artist Name</h3>
  {{ product.music_info[0].artists.name }}
  <h3>Artist Bio</h3>
  {{ product.music_info[0].artists.bio }}
</div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      <div class="jumbotron p-3">
      <h2>Manage Songs 
        <button type="button" class="btn btn-success float-end" data-bs-toggle="modal"data-bs-target="#addsongmodal">Add New Song</button>
        <button type="button" class="btn btn-warning float-end" style="margin-right: 10px;" data-bs-toggle="modal"data-bs-target="#editdetailsmodal">Edit Details</button>
      </h2>

      {% with messages = get_flashed_messages() %}

      {% if messages %}

      {% for message in messages %}
      <div class="alert alert-success alert-dismissable" role="alert">
        {{ message }}
        <button type="button" class="btn-close float-end" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>

      {% endfor %}
      {% endif %}
      {% endwith%}
      <table class="table table-hover table-dark">
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Length</th>
          <th>Edit</th>
          <th>Delete</th>
        </tr>
        {% for song in product.music_info[0].songs: %}
        <tr>
          <td>{{ song.song_id }}</td>
          <td>{{ song.name }}</td>
          <td>{{ song.length }} seconds</td>
          <td><a class="btn btn-warning btn-xs" data-bs-toggle="modal"
              data-bs-target="">Edit</a></td>
          <td><a href="" type="button" class="btn btn-danger btn-xs"
              onclick="">Delete</button></td>
        </tr>

        {% endfor %}

      </table>
      </div>
    </div>
  </div>
</div>
{% else %}
<div class="container text-white">
  <h3>Add Product Details</h3>
  <div class="row">
    <div class="col-md-12">
      <div class="jumbotron p-3">
        <form action="" method="POST">
          {{ details_form.csrf_token }}
          {{ details_form.hidden_tag() }}
          <div class="modal-body">
            <div class="form-group">
              <label>{{ details_form.album_name.label }}</label>
              {{ details_form.album_name(class="form-control bg-secondary text-white") }}
            </div>
            <div class="form-group">
              <label>{{ details_form.year.label }}</label>
              {{ details_form.year(class="form-control bg-secondary text-white") }}
            </div>
            <div class="form-group">
              <label>{{ details_form.artist_name.label }}</label>
              {{ details_form.artist_name(class="form-control bg-secondary text-white") }}
            </div>
            <div class="form-group">
              <label>{{ details_form.artist_bio.label }}</label>
              {{ details_form.artist_bio(class="form-control bg-secondary text-white") }}
            </div>
            <div class="form-group">
              <label>{{ details_form.genres.label }}</label>
              {{ details_form.genres(class="form-control bg-secondary text-white") }}
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            {{ details_form.submit(class="btn btn-primary") }}
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endif %}
<!-- Add Song Modal -->
<div class="modal fade" id="addsongmodal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Add Song</h5>
      </div>
      <form action="" method="POST">
        {{ song_form.csrf_token }}
        {{ song_form.hidden_tag() }}
        <div class="modal-body">
          <div class="form-group">
            <label>{{ song_form.name.label }}</label>
            {{ song_form.name(class="form-control bg-secondary text-white") }}
          </div>
          <div class="form-group">
            <label>{{ song_form.length.label }}</label>
            {{ song_form.length(class="form-control bg-secondary text-white") }}
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          {{ song_form.submit(class="btn btn-primary") }}
        </div>
      </form>
    </div>
  </div>
</div>



<!-- Edit Product Details Modal -->
<div class="modal fade" id="editdetailsmodal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Edit Details</h5>
      </div>
      <form action="" method="POST">
        {{ details_form.csrf_token }}
        {{ details_form.hidden_tag() }}
        <div class="modal-body">
          <div class="form-group">
            <label>{{ details_form.album_name.label }}</label>
            {{ details_form.album_name(class="form-control bg-secondary text-white", value=product.music_info[0].name) }}
          </div>
          <div class="form-group">
            <label>{{ details_form.year.label }}</label>
            {{ details_form.year(class="form-control bg-secondary text-white", value=product.music_info[0].year) }}
          </div>
          <div class="form-group">
            <label>{{ details_form.artist_name.label }}</label>
            {{ details_form.artist_name(class="form-control bg-secondary text-white, value=product.music_info[0].artists.name") }}
          </div>
          <div class="form-group">
            <label>{{ details_form.artist_bio.label }}</label>
            {{ details_form.artist_bio(class="form-control bg-secondary text-white, value=product.music_info[0].artists.bio") }}
          </div>
          <div class="form-group">
            <label>{{ details_form.genres.label }}</label>
            {{ details_form.genres(class="form-control bg-secondary text-white") }}
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          {{ details_form.submit(class="btn btn-primary") }}
        </div>
      </form>
    </div>
  </div>
</div>

{% endblock %}